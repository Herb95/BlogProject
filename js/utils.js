HTMLElement.prototype.wrap=function(e){this.parentNode.insertBefore(e,this);this.parentNode.removeChild(this);e.appendChild(this)};(function(){const e=()=>document.dispatchEvent(new Event("page:loaded",{bubbles:true}));if(document.readyState==="loading"){document.addEventListener("readystatechange",e,{once:true})}else{e()}document.addEventListener("pjax:success",e)})();NexT.utils={registerExtURL:function(){document.querySelectorAll("span.exturl").forEach(e=>{const t=document.createElement("a");t.href=decodeURIComponent(atob(e.dataset.url).split("").map(e=>{return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)}).join(""));t.rel="noopener external nofollow noreferrer";t.target="_blank";t.className=e.className;t.title=e.title;t.innerHTML=e.innerHTML;e.parentNode.replaceChild(t,e)})},registerCodeblock:function(e){const r=!!e;let t=(r?e:document).querySelectorAll("figure.highlight");let s=true;if(t.length===0){t=document.querySelectorAll("pre:not(.mermaid)");s=false}t.forEach(i=>{if(!r){let e=i.querySelectorAll(".code .line span");if(e.length===0){e=i.querySelectorAll("code.highlight span")}e.forEach(t=>{t.classList.forEach(e=>{t.classList.replace(e,`hljs-${e}`)})})}const e=parseInt(window.getComputedStyle(i).height.replace("px",""),10);const t=CONFIG.fold.enable&&e>CONFIG.fold.height;if(!t&&!CONFIG.copycode.enable)return;let n;if(s&&CONFIG.copycode.style==="mac"){n=i}else{let e=i.querySelector(".code-container");if(!e){const o=i.querySelector(".table-container")||i;e=document.createElement("div");e.className="code-container";o.wrap(e)}n=e}if(t&&!n.classList.contains("unfold")){n.classList.add("highlight-fold");n.insertAdjacentHTML("beforeend",'<div class="fold-cover"></div><div class="expand-btn"><i class="fa fa-angle-down fa-fw"></i></div>');n.querySelector(".expand-btn").addEventListener("click",()=>{n.classList.remove("highlight-fold");n.classList.add("unfold")})}if(r||!CONFIG.copycode.enable)return;n.insertAdjacentHTML("beforeend",'<div class="copy-btn"><i class="fa fa-copy fa-fw"></i></div>');const c=n.querySelector(".copy-btn");c.addEventListener("click",()=>{const e=i.querySelector(".code")||i.querySelector("code");const t=e.innerText;if(navigator.clipboard){navigator.clipboard.writeText(t).then(()=>{c.querySelector("i").className="fa fa-check-circle fa-fw"},()=>{c.querySelector("i").className="fa fa-times-circle fa-fw"})}else{const n=document.createElement("textarea");n.style.top=window.scrollY+"px";n.style.position="absolute";n.style.opacity="0";n.readOnly=true;n.value=t;document.body.append(n);n.select();n.setSelectionRange(0,t.length);n.readOnly=false;const o=document.execCommand("copy");c.querySelector("i").className=o?"fa fa-check-circle fa-fw":"fa fa-times-circle fa-fw";n.blur();c.blur();document.body.removeChild(n)}});i.addEventListener("mouseleave",()=>{setTimeout(()=>{c.querySelector("i").className="fa fa-copy fa-fw"},300)})})},wrapTableWithBox:function(){document.querySelectorAll("table").forEach(e=>{const t=document.createElement("div");t.className="table-container";e.wrap(t)})},registerVideoIframe:function(){document.querySelectorAll("iframe").forEach(t=>{const e=["www.youtube.com","player.vimeo.com","player.youku.com","player.bilibili.com","www.tudou.com"].some(e=>t.src.includes(e));if(e&&!t.parentNode.matches(".video-container")){const n=document.createElement("div");n.className="video-container";t.wrap(n);const o=Number(t.width);const i=Number(t.height);if(o&&i){n.style.paddingTop=i/o*100+"%"}}})},updateActiveNav:function(){if(!Array.isArray(NexT.utils.sections))return;let e=NexT.utils.sections.findIndex(e=>{return e&&e.getBoundingClientRect().top>10});if(e===-1){e=NexT.utils.sections.length-1}else if(e>0){e--}this.activateNavByIndex(e)},registerScrollPercent:function(){const n=document.querySelector(".back-to-top");const o=document.querySelector(".reading-progress-bar");window.addEventListener("scroll",()=>{if(n||o){const e=document.body.scrollHeight-window.innerHeight;const t=e>0?Math.min(100*window.scrollY/e,100):0;if(n){n.classList.toggle("back-to-top-on",Math.round(t)>=5);n.querySelector("span").innerText=Math.round(t)+"%"}if(o){o.style.setProperty("--progress",t.toFixed(2)+"%")}}this.updateActiveNav()},{passive:true});n&&n.addEventListener("click",()=>{window.anime({targets:document.scrollingElement,duration:500,easing:"linear",scrollTop:0})})},registerTabsTag:function(){document.querySelectorAll(".tabs ul.nav-tabs .tab").forEach(u=>{u.addEventListener("click",e=>{e.preventDefault();if(u.classList.contains("active"))return;const t=u.parentNode;const n=t.nextElementSibling;n.style.overflow="hidden";n.style.transition="height 1s";const o=n.querySelector(".active")||n.firstElementChild;const i=parseInt(window.getComputedStyle(o).height.replace("px",""),10)||0;const c=parseInt(window.getComputedStyle(o).paddingTop.replace("px",""),10);const r=parseInt(window.getComputedStyle(o.firstElementChild).marginBottom.replace("px",""),10);n.style.height=i+c+r+"px";[...t.children].forEach(e=>{e.classList.toggle("active",e===u)});const s=document.getElementById(u.querySelector("a").getAttribute("href").replace("#",""));[...s.parentNode.children].forEach(e=>{e.classList.toggle("active",e===s)});s.dispatchEvent(new Event("tabs:click",{bubbles:true}));const a=document.body.scrollHeight>(window.innerHeight||document.documentElement.clientHeight);const l=parseInt(window.getComputedStyle(n.querySelector(".active")).height.replace("px",""),10);n.style.height=l+c+r+"px";setTimeout(()=>{if(document.body.scrollHeight>(window.innerHeight||document.documentElement.clientHeight)!==a){n.style.transition="height 0.3s linear";const e=parseInt(window.getComputedStyle(n.querySelector(".active")).height.replace("px",""),10);n.style.height=e+c+r+"px"}setTimeout(()=>{n.style.transition="";n.style.height=""},250)},1e3);if(!CONFIG.stickytabs)return;const d=t.parentNode.getBoundingClientRect().top+window.scrollY+10;window.anime({targets:document.scrollingElement,duration:500,easing:"linear",scrollTop:d})})});window.dispatchEvent(new Event("tabs:register"))},registerCanIUseTag:function(){window.addEventListener("message",({data:e})=>{if(typeof e==="string"&&e.includes("ciu_embed")){const t=e.split(":")[1];const n=e.split(":")[2];document.querySelector(`iframe[data-feature=${t}]`).style.height=parseInt(n,10)+5+"px"}},false)},registerActiveMenuItem:function(){document.querySelectorAll(".menu-item a[href]").forEach(e=>{const t=e.pathname===location.pathname||e.pathname===location.pathname.replace("index.html","");const n=!CONFIG.root.startsWith(e.pathname)&&location.pathname.startsWith(e.pathname);e.classList.toggle("menu-item-active",e.hostname===location.hostname&&(t||n))})},registerLangSelect:function(){const e=document.querySelectorAll(".lang-select");e.forEach(e=>{e.value=CONFIG.page.lang;e.addEventListener("change",()=>{const t=e.options[e.selectedIndex];document.querySelectorAll(".lang-select-label span").forEach(e=>{e.innerText=t.text});window.location.href=t.dataset.href})})},registerSidebarTOC:function(){this.sections=[...document.querySelectorAll(".post-toc:not(.placeholder-toc) li a.nav-link")].map(n=>{const o=document.getElementById(decodeURI(n.getAttribute("href")).replace("#",""));n.addEventListener("click",e=>{e.preventDefault();const t=o.getBoundingClientRect().top+window.scrollY;window.anime({targets:document.scrollingElement,duration:500,easing:"linear",scrollTop:t,complete:()=>{history.pushState(null,document.title,n.href)}})});return o});this.updateActiveNav()},registerPostReward:function(){const e=document.querySelector(".reward-container button");if(!e)return;e.addEventListener("click",()=>{document.querySelector(".post-reward").classList.toggle("active")})},activateNavByIndex:function(e){const t=document.querySelector(".post-toc:not(.placeholder-toc) .nav");if(!t)return;const n=t.querySelectorAll(".nav-item");const o=n[e];if(!o||o.classList.contains("active-current"))return;const i=n[n.length-1].offsetHeight;t.querySelectorAll(".active").forEach(e=>{e.classList.remove("active","active-current")});o.classList.add("active","active-current");let c=o.querySelector(".nav-child")||o.parentElement;let r=0;while(t.contains(c)){if(c.classList.contains("nav-item")){c.classList.add("active")}else{r+=i*c.childElementCount+5;c.style.setProperty("--height",`${r}px`)}c=c.parentElement}const s=document.querySelector(CONFIG.scheme==="Pisces"||CONFIG.scheme==="Gemini"?".sidebar-panel-container":".sidebar");if(!document.querySelector(".sidebar-toc-active"))return;window.anime({targets:s,duration:200,easing:"linear",scrollTop:s.scrollTop-s.offsetHeight/2+o.getBoundingClientRect().top-s.getBoundingClientRect().top})},updateSidebarPosition:function(){if(window.innerWidth<1200||CONFIG.scheme==="Pisces"||CONFIG.scheme==="Gemini")return;const e=document.querySelector(".post-toc:not(.placeholder-toc)");let t=CONFIG.page.sidebar;if(typeof t!=="boolean"){t=CONFIG.sidebar.display==="always"||CONFIG.sidebar.display==="post"&&e}if(t){window.dispatchEvent(new Event("sidebar:show"))}},activateSidebarPanel:function(e){const t=document.querySelector(".sidebar-inner");const n=["sidebar-toc-active","sidebar-overview-active"];if(t.classList.contains(n[e]))return;const o=t.querySelector(".sidebar-panel-container");const i=o.firstElementChild;const c=o.lastElementChild;let r=i.scrollHeight;if(e===0){const a=i.querySelector(".nav");if(a){r=parseInt(a.style.getPropertyValue("--height"),10)}}const s=[r,c.scrollHeight];o.style.setProperty("--inactive-panel-height",`${s[1-e]}px`);o.style.setProperty("--active-panel-height",`${s[e]}px`);t.classList.replace(n[1-e],n[e])},getScript:function(c,e={},t){if(typeof e==="function"){return this.getScript(c,{condition:t}).then(e)}const{condition:r=false,attributes:{id:s="",async:a=false,defer:l=false,crossOrigin:d="",dataset:u={},...p}={},parentNode:m=null}=e;return new Promise((e,t)=>{if(r){e()}else{const n=document.createElement("script");if(s)n.id=s;if(d)n.crossOrigin=d;n.async=a;n.defer=l;Object.assign(n.dataset,u);Object.entries(p).forEach(([e,t])=>{n.setAttribute(e,String(t))});n.onload=e;n.onerror=t;if(typeof c==="object"){const{url:o,integrity:i}=c;n.src=o;if(i){n.integrity=i;n.crossOrigin="anonymous"}}else{n.src=c}(m||document.head).appendChild(n)}})},loadComments:function(n,e){if(e){return this.loadComments(n).then(e)}return new Promise(o=>{const e=document.querySelector(n);if(!CONFIG.comments.lazyload||!e){o();return}const t=new IntersectionObserver((e,t)=>{const n=e[0];if(!n.isIntersecting)return;o();t.disconnect()});t.observe(e)})}};